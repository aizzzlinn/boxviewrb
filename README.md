# BoxViewRb

A BoxView API wrapper. Built using the power of HTTParty to communicate with the BoxView API. The BoxView API has added some new features and improved documentation, this lib takes care of all of those new additions for you. You can learn more at the developer page: http://developers.box.com/view/. Note this product and API are still in beta, and likely to change in the future. BoxViewRb works with all available requests (except multipart uploads) that are documented by BoxView at the time of writing.

##### Table of Contents
* [Installation](#installation)
* [Usage](#usage)
    * [Configuration](#configuration)
    * [Document](#document)
        * [Create](#create_document)
        * [MultiPart](#multipart)
        * [List](#list)
        * [Show](#show)
        * [Update](#update)
        * [Thumbnail](#thumbnail)
        * [Assets](#assets)
    * [Session](#session)
        * [Create](#create_session)
    * [Convenience Methods](#convenience_methods)
        * [Never Expire](#never_expire)
        * [View](#create_session)
        * [ViewerJS URL](#viewerjs_url)
        * [Viewer URL](#viewer_url)
        * [Supported MIMETypes](#supported_mimetypes)
        * [Supported File Extensions](#supported_file_extensions)
* [Contributing](#contributing)
* [Author](#author)
* [License](#license)

<a name="installation"/>
## Installation

Add this line to your application's Gemfile:

    gem 'boxviewrb'

And then execute:

    $ bundle

Or install it yourself as:

    $ gem install boxviewrb

<a name="usage"/>
## Usage

<a name="configuration"/>
### Configuration

Defining an api key is the only required configuration. To get your own API Key, visit Box.com and get a developer account. Then create a new Box View application. Scroll to the bottom of the application settings page to find your api key.

```ruby
BoxView.api_key = 'gyheecmm6ckk8jutlowlzfh2tbg72kck'
```

<a name="document"/>
### Document

<a name="create_document"/>
#### Create

See below for how to create a document using BoxViewRb. Not all the paramaters used are required. The url is the only parameter that will be necessary in order to make a successful call with the BoxView API. Name refers to the name of the document. Non_SVG refers to whether you want to support browsers that cannot support svg. The Height and Width parameters refer to the size of a thumbnail that will give Box an early start to generating your thumbnail for you. You must still make a second request for a thumbnail, but it will be made available sooner upon request.

After making this call the BoxView API if successful will return with a response. The response will contain a document id that you can use to make various other calls. BoxViewRb will automatically have the document id available when the response is returned. If the call to BoxView fails, a specific error will be raised depending on what went wrong.

```ruby
BoxView::Document.url 'http://seriouscatbusiness.com/pussycats.pdf'
BoxView::Document.name 'pussycats'
BoxView::Document.non_svg true
BoxView::Document.width 100
BoxView::Document.height 100
BoxView::Document.create

# Alternatively:
BoxView::Document.create
  url: 'http://seriousmonkeybusiness.com/chimpanzee.docx',
  name: 'chimpanzee',
  non_svg: true,
  width: 100,
  height: 100
```

<a name="multipart"/>
#### MultiPart

Coming Soon...

<a name="list"/>
#### List

This request will respond with a list of all the documents that are currently tied to the api key that has been supplied. Delete requests will remove documents from this list. This method returns the response untouched.

```ruby
BoxView::Document.list
```

<a name="show"/>
#### Show

Returns the metadata for a single document based on a specified document id. If the document has successfully been generated by box, the status of the document will be 'done'. If not the status will be 'error'. The status is returned in the response when calling show.

```ruby
BoxView.document_id = '937778a1a54b4337a5351a78f7188a24'
BoxView::Document.show

# Alternatively:
BoxView::Document.show document_id: '937778a1a54b4337a5351a78f7188a24'
```

<a name="update"/>
#### Update

Update the metadata of a single document based on a specified document id. Only the name can be updated at this time.

```ruby
BoxView.document_id = '937778a1a54b4337a5351a78f7188a24'
BoxView::Document.name = 'recipes'
BoxView::Document.update

# Alternatively:
BoxView::Document.update
  document_id: '937778a1a54b4337a5351a78f7188a24',
  name: 'recipes'
```

<a name="thumbnail"/>
#### Thumbnail

A request to retrieve a thumbnail representation of a document. A document id must be specified in order to make the request.

```ruby
BoxView.document_id = '937778a1a54b4337a5351a78f7188a24'
BoxView::Document.width = 100
BoxView::Document.height = 100
BoxView::Document.thumbnail

#Alternatively:
BoxView::Document.thumbnail
  document_id: '937778a1a54b4337a5351a78f7188a24',
  width: 100,
  height: 100
```

<a name="assets"/>
#### Assets

A request to retrieve a pdf or zip of the asset that was uploaded. The document will be retrieved as a pdf or zip. The zip contains compressed css/js/html that make up the converted document. This can be used in junction with viewerjs. This request defaults to zip if no type is specified.

```ruby
BoxView.document_id = '937778a1a54b4337a5351a78f7188a24'
BoxView::Document.type = 'PDF'
BoxView::Document.assets

#Alternatively:
BoxView::Document.assets
  document_id: '937778a1a54b4337a5351a78f7188a24',
  type: 'pdf'
```

<a name="session"/>
### Session

<a name="create_session"/>
#### Create

Generating a document will give you a document id. Next you can create a session using this id. The session will begin the conversion process of the document. When Box is done converting your document it will be available to download through the assets method or the viewer url convenience method. A session expires after a set amount of time. You can set a duration or an expiration date for the session. If left blank, the session is set by box by default to expire in 60 minutes. Duration is marked in minutes. Expiration date is a timestamp. The variable is_downloadable refers to whether or not the box viewer will display a download button or not.

After successfully generating a session, the session id will be available. You can either parse it out of the response that is returned, or just call 'BoxView.session_id'.

```ruby
BoxView.document_id = '937778a1a54b4337a5351a78f7188a24'
BoxView::Session.duration = 100
BoxView::Session.expiration_date = Time.now + 100.minutes
BoxView::Session.is_downloadable = true
BoxView::Session.create

#Alternatively
BoxView::Session.create
  document_id: '937778a1a54b4337a5351a78f7188a24',
  duration: 100,
  expiration_date: (Time.now + 100.minutes),
  is_downloadable: true
```

<a name="convenience_methods"/>
### Convenience Methods

<a name="never_expire"/>
#### Never Expire

When generating a session if you want your session to last for a very long time (a thousand years) call this method.

```ruby
BoxView::Session.never_expire
```

<a name="view"/>
#### View

Opens a default browser using the viewer url to view a BoxView converted document. Requires a session_id.

```ruby
BoxView::Session.view
```

<a name="viewerjs_url"/>
#### ViewerJS URL

This url can be used with viewerjs to display the assets without using the Box iframe or downloading the assets yourself. Requires a session_id.

```ruby
BoxView::Session.viewerjs_url
```

<a name="viewer_url"/>
#### Viewer URL

The url used in the view method. Can be used in an iframe to display the converted document. Requires a session_id.

```ruby
BoxView::Session.viewer_url
```

<a name="supported_mimetypes"/>
#### Supported MIMETypes

Returns an array containing all the mimetypes that BoxView is known to support.

```ruby
BoxView::Document.supported_mimetypes
```

<a name="supported_file_extensions"/>
#### Supported File Extensions

Returns an array containing all the extensions of filetypes that BoxView is known to support.

```ruby
BoxView::Document.supported_file_extensions
```

<a name="contributing"/>
## Contributing

1. Fork it ( https://github.com/[my-github-username]/boxviewrb/fork )
2. Create your feature branch (`git checkout -b my-new-feature`)
3. Commit your changes (`git commit -am 'Add some feature'`)
4. Push to the branch (`git push origin my-new-feature`)
5. Create a new Pull Request

<a name="author"/>
## Author

Vincent Taverna, vinny@getlua.com, [http://vinnymac.github.io](vinnymac.github.io)

<a name="license"/>
## License

BoxViewRb is available under the MIT license. See the [LICENSE.txt](LICENSE) file for more information.